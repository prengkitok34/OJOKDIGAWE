<!DOCTYPE html>
<html>
<head>
  <title>Inbox Mailxstres</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .email { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
    button { margin-top: 5px; }
  </style>
</head>
<body>
  <h2>Inbox untuk: <span id="emailUser"></span>@mailxstres.org</h2>
  <input type="text" id="userInput" placeholder="Masukkan username...">
  <button onclick="loadInbox()">Lihat Inbox</button>

  <div id="inbox"></div>

  <script>
    function loadInbox() {
      const user = document.getElementById('userInput').value.trim();
      if (!user) return alert('Masukkan username!');
      document.getElementById('emailUser').innerText = user;

      fetch(`https://mailxstres.org/mailapi/inbox.php?user=${user}`)
        .then(res => res.json())
        .then(data => {
          const inbox = document.getElementById('inbox');
          inbox.innerHTML = '';

          data.forEach(email => {
            const div = document.createElement('div');
            div.className = 'email';
            div.innerHTML = `
              <strong>Dari:</strong> ${email.from}<br>
              <strong>Subjek:</strong> ${email.subject}<br>
              <strong>Tanggal:</strong> ${email.date}<br>
              <strong>OTP:</strong> ${email.otp || '(tidak ada)'}<br>
              <button onclick="copyOTP('${email.otp}')">Salin OTP</button>
              <details><summary>Lihat isi</summary><pre>${email.body}</pre></details>
            `;
            inbox.appendChild(div);
          });
        });
    }

    function copyOTP(code) {
      if (!code) return alert('Tidak ada OTP di email ini.');
      navigator.clipboard.writeText(code).then(() => {
        alert('OTP disalin: ' + code);
      });
    }
  </script>
</body>
</html>
